# TrainTracking - система отслеживания вагонов

Код реализован в рамках тестового задания. Представляет собой сервис для работы с базой данных, веб-прослойку для отправки запросов и отображения ответов и решение для контрактов системы. Из базы данных выбираются события ЕПС (единицы подвижного состава) и формируются в историю станции по временной выборке

<img width="1410" height="920" alt="image" src="https://github.com/user-attachments/assets/9428fa62-85fa-4ac0-8eff-4e33600591af" />
<img width="1305" height="325" alt="image" src="https://github.com/user-attachments/assets/7df59371-75dc-4e38-b496-f8d6f8434a3c" />


## Проблематика

В файле бэкапа базы данных является бэкап базы данных, из которого нужно восстановить историю станции. В части таблиц отсутствуют первичные ключи, что накладывает определенные трудности. 


<img width="953" height="284" alt="image" src="https://github.com/user-attachments/assets/768bcf51-1900-4f4d-945a-267abc346e19" />


Мы имеем несколько путей решения проблемы:

1. Генерация миграции после применения бэкапа и выдача существующим записям идентификаторов (без первичных ключей увеличивается сложность запросов, ограничения индексации и другие вытекающие проблемы), но работа должна быть выполнена в рамках заданных условий
2. Использование EntityFramework с авто-генерацией запросов по составным ключам или Dapper и заранее определенные SQL запросы для таблиц
3. Использование ключей по хешу записей

Выбор был сделан в пользу второго варианта с составными ключами.

## Компоненты системы

Код написан с использованием C# 12 и .NET 8. Содержит в себе следующие компоненты:

```
TrainTracking/
├── TrainStationService/     # Backend gRPC сервис
├── TrainStationClient/      # Frontend на Razor Pages
├── TrainStationContracts/   # gRPC контракты
└── docker-compose.yml       # Оркестрация контейнеров
```

### Используемые паттерны
- **Service Layer Pattern** для сервисов
- **Mapper Pattern** для преобразования данных
- **Extension Methods** для фильтрации запросов
- **Fluent Configuration** для Entity Framework
- **Dependency Injection** с extension методами

## Запуск

1. Клонирование репозитория

```
git clone https://github.com/ppulseneon/TrainTracking.git
cd TrainTracking
```

2. Запуск Docker Compose

```
# Запуск сервисов
docker-compose up -d

# Проверка статуса 
docker-compose ps
```

3. Фронтенд будет доступен по адресу http://localhost:5000 (бэк на http://localhost:7134)

> При запуске база данных автоматически подтягивает бэкап базы из файла, прикрпеленного вместе с ТЗ

